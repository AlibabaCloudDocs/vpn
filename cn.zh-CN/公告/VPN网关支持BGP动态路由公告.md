# VPN网关支持BGP动态路由公告

VPN网关支持BGP（Border Gateway Protocol）动态路由功能，云上云下通过VPN网关建立连接，并通过BGP动态路由协议自动学习路由实现资源互通，降低网络维护成本和网络配置风险。

**说明：** 目前，除华南2（河源）外的所有地域都已支持BGP动态路由功能。

## BGP动态路由简介

BGP是一种基于TCP协议的动态路由协议，主要应用于不同自治系统间交换路由信息和网络可达信息。

VPN网关的BGP动态路由功能是在IPsec连接的基础上增加的子功能。BGP动态路由集成CEN动态路由收发能力，帮助您更高效、灵活且可靠的建立VPN连接，实现云上和云下网络的互通。

BGP动态路由具有以下能力：

-   自动宣告云上和云下的动态路由，并具备自动处理路由冲突机制。
-   同时支持静态路由和动态路由，实现自定义指定流量出口。
-   同一VPN网关与同一本地数据中心创建多隧道连接，支持等值多路径路由协议（ECMP），实现高可用容灾。

**说明：** 使用BGP动态路由建立VPN连接前，您必须了解以下注意事项：

-   如果您使用物理专线和VPN网关以主备的方式将云下本地数据中心接入云上VPC，为避免本地数据中心网络路由震荡，请确保边界路由器和VPN网关配置的本地数据中心的自治系统号（ASN）一致。
-   如果您有多个VPC加载到同一云企业网，为避免云上网络路由震荡，请确保VPC关联的VPN网关未使用BGP路由协议建立连接。
-   如果您使用同一云上VPN网关与不同本地数据中心建立VPN连接，禁止将不同VPN连接的路由互导。
-   如果一个VPC创建了多个VPN网关，禁止将不同VPN网关的路由互导。

## 动态路由宣告原则

使用VPN网关建立VPN连接后，动态路由宣告原则如下：

-   云下到云上方向

    云下VPN网关通过BGP动态路由协议自动学习云下数据中心网段路由，并自动宣告给云上VPN网关。如果云上VPN网关开启了BGP路由自动传播功能，则云上VPN网关会将学习到的BGP路由自动传播到VPC的系统路由表中，而不会传播到VPC的自定义路由表中。

-   云上到云下方向

    云上VPN网关通过BGP路由协议自动学习VPC系统路由表中的路由，并自动宣告给云下数据中心侧VPN网关，而不会学习VPC自定义路由表中的路由。


## 路由优先级原则

如果VPN网关路由表或VPC路由表中存在路由冲突，各路由的优先级如下表所示。

**说明：** 路由优先级从高到底依次为：P0\>P1\>P2\>P3。

|路由类别|VPN网关内路由优先级|VPC内路由优先级|
|----|-----------|---------|
|明细路由|P0|P0|
|系统路由|P1|P1|
|静态路由|P2|P2|
|动态路由|P3|P3|

## 使用限制

单个VPN网关的BGP路由表支持的路由条目数为50条。如需提升配额，请[提交工单](https://selfservice.console.aliyun.com/ticket/category/vpn/today)。

## 使用教程

操作详情，请参见[建立VPC到本地数据中心的连接（BGP动态路由）](/cn.zh-CN/IPsec-VPN入门/建立VPC到本地数据中心的连接（BGP动态路由）.md)

